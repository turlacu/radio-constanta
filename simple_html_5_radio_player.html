<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Radio Constanța — Simple HTML5 Player</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#071028 0%,#071b2a 100%);color:#e6eef6}
    .wrap{max-width:720px;margin:36px auto;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    h1{font-size:20px;margin:0 0 8px}
    p.lead{margin:0 0 18px;color:var(--muted);font-size:14px}
    .stations{display:flex;flex-direction:column;gap:8px}
    .station{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-radius:8px;background:rgba(255,255,255,0.02);cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
    .station.active{box-shadow:0 6px 18px rgba(6,182,212,0.08);border-color:rgba(6,182,212,0.18)}
    .station .meta{display:flex;flex-direction:column}
    .station .name{font-weight:600}
    .station .bitrate{font-size:12px;color:var(--muted)}
    .controls{display:flex;align-items:center;gap:12px;margin-top:18px}
    .btn{appearance:none;border:0;padding:10px 14px;border-radius:10px;background:var(--accent);color:#042027;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--accent);border:1px solid rgba(6,182,212,0.14)}
    .status{margin-left:auto;font-size:13px;color:var(--muted)}
    .volume{display:flex;align-items:center;gap:8px}
    input[type=range]{width:160px}
    .fallback{margin-top:12px;font-size:13px;color:var(--muted)}
    .footer{margin-top:16px;font-size:12px;color:var(--muted)}
    @media (max-width:420px){.controls{flex-direction:column;align-items:stretch}input[type=range]{width:100%}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Radio Constanța — Simple Player</h1>
    <p class="lead">Tap a station, then press Play. Works on mobile Chrome/Edge (user gesture required for audio).</p>

    <div id="stations" class="stations" aria-label="Stations list"></div>

    <div class="controls">
      <button id="playBtn" class="btn">Play</button>
      <button id="stopBtn" class="btn secondary">Stop</button>

      <div class="volume">
        <label for="vol">Vol</label>
        <input id="vol" type="range" min="0" max="1" step="0.01" value="1">
      </div>

      <div id="status" class="status">Idle</div>
    </div>

    <div id="fallback" class="fallback"></div>
    <div class="footer">If a stream doesn't play on mobile, your browser or the stream may block cross-origin requests. See notes below.</div>

    <audio id="player" preload="none"></audio>
  </div>

  <script>
    // Stations list (the user-provided stream URLs)
    const stations = [
      {id:'rc_folclor_128', title:'Radio Constanța Folclor — 128 kbps', url:'https://stream4.srr.ro:8443/radio-constanta-am', bitrate:'128 kbps'},
      {id:'rc_folclor_256', title:'Radio Constanța Folclor — 256 kbps', url:'http://stream2.srr.ro:8336/radio-constanta-am', bitrate:'256 kbps'},
      {id:'rc_fm_128', title:'Radio Constanța FM — 128 kbps', url:'https://stream4.srr.ro:8443/radio-constanta-fm', bitrate:'128 kbps'},
      {id:'rc_fm_256', title:'Radio Constanța FM — 256 kbps', url:'http://stream2.srr.ro:8332/radio-constanta-fm', bitrate:'256 kbps'}
    ];

    const player = document.getElementById('player');
    const stationsContainer = document.getElementById('stations');
    const playBtn = document.getElementById('playBtn');
    const stopBtn = document.getElementById('stopBtn');
    const vol = document.getElementById('vol');
    const status = document.getElementById('status');
    const fallback = document.getElementById('fallback');

    let current = null;

    function renderStations(){
      stationsContainer.innerHTML = '';
      stations.forEach(s => {
        const el = document.createElement('button');
        el.className = 'station';
        el.type = 'button';
        el.innerHTML = `<div class="meta"><div class="name">${s.title}</div><div class="bitrate">${s.bitrate}</div></div><div>▶</div>`;
        el.addEventListener('click', ()=>selectStation(s, el));
        stationsContainer.appendChild(el);
      });
    }

    function selectStation(s, el){
      // Remove active class from others
      Array.from(stationsContainer.children).forEach(node => node.classList.remove('active'));
      el.classList.add('active');
      current = s;
      player.src = s.url;
      player.type = 'audio/mpeg';
      fallback.innerHTML = `Direct stream URL: <a href="${s.url}" target="_blank" rel="noopener noreferrer">${s.url}</a>`;
      status.textContent = 'Selected: ' + s.title;
    }

    playBtn.addEventListener('click', async ()=>{
      if(!current){ status.textContent = 'Select a station first'; return; }
      try{
        status.textContent = 'Connecting...';
        await player.play(); // user gesture required on mobile
        status.textContent = 'Playing — ' + current.title;
        playBtn.textContent = 'Pause';
      }catch(err){
        console.error('Play error', err);
        status.textContent = 'Play failed — see fallback below';
      }
    });

    stopBtn.addEventListener('click', ()=>{
      player.pause();
      player.currentTime = 0;
      status.textContent = 'Stopped';
      playBtn.textContent = 'Play';
    });

    // Toggle play/pause when clicking Play button after started
    playBtn.addEventListener('click', ()=>{
      if(player.paused){
        // first click handled above via play() promise; subsequent clicks toggled here
      }else{
        player.pause();
        playBtn.textContent = 'Play';
        status.textContent = 'Paused';
      }
    });

    // Keep volume synced
    vol.addEventListener('input', ()=>{ player.volume = parseFloat(vol.value); });

    // Player events
    player.addEventListener('playing', ()=>{ status.textContent = 'Playing — ' + (current? current.title : ''); playBtn.textContent='Pause'; });
    player.addEventListener('pause', ()=>{ status.textContent = 'Paused'; playBtn.textContent='Play'; });
    player.addEventListener('error', (e)=>{
      console.error('Audio element error', e);
      status.textContent = 'Error playing stream — open direct link below';
    });
    player.addEventListener('stalled', ()=>{ status.textContent = 'Stalled — network or stream issue'; });
    player.addEventListener('waiting', ()=>{ status.textContent = 'Buffering...'; });

    // Render UI
    renderStations();

    // Notes for devs: mobile browsers block autoplay; a user gesture (tap) is required. If the
    // stream doesn't play, CORS or the streaming server may block requests from browsers. In that case
    // use a small proxy (server-side) that forwards the stream with proper CORS headers.
  </script>
</body>
</html>
